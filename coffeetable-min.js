(function(){var l,b,q,G,H,t,I,z,J,A,r,h,k,B,m,K,u,C,v,i,D,L,w,M,E,x,F,d,s,y,N,O,p=Array.prototype.slice;J={autoload_coffee_script:!0,autoload_jquery:!0,coffeescript_js:"http://code.alecperkins.net/coffeetable/lib/coffee_script-1.1.1-min.js",jquery_js:"http://code.alecperkins.net/coffeetable/lib/jquery-1.6.2-min.js",local_storage:!0,ls_key:"coffee-table",clear_on_load:!1,replay_on_load:!1,multi_line:!1,indent:"    ",auto_suggest:!0,widget_position:"fixed",widget_top:"5px",widget_right:"5px",widget_id:"CoffeeTable-"+
(new Date).getTime(),alias_log:!0,alias_dir:!0,adopt_log:!0,adopt_dir:!0};m={UP:38,DOWN:40,ENTER:13,TAB:9,BACKSPACE:8,ESCAPE:27};y='<div id="__ID__">\n    <style type="text/css">\n        #__ID__{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;-webkit-box-shadow:0px 0px 4px #222;-moz-box-shadow:0px 0px 4px #222;box-shadow:0px 0px 4px #222;background:rgba(255,255,255,0.93);padding:0;border:2px solid #fff;z-index:2147483647;font-size:12px;font-family:Verdana,sans-serif;max-height:95%;max-width:900px;color:#000}#__ID__ div,#__ID__ span,#__ID__ applet,#__ID__ object,#__ID__ iframe,#__ID__ h1,#__ID__ h2,#__ID__ h3,#__ID__ h4,#__ID__ h5,#__ID__ h6,#__ID__ p,#__ID__ blockquote,#__ID__ pre,#__ID__ a,#__ID__ abbr,#__ID__ acronym,#__ID__ address,#__ID__ big,#__ID__ cite,#__ID__ code,#__ID__ del,#__ID__ dfn,#__ID__ em,#__ID__ img,#__ID__ ins,#__ID__ kbd,#__ID__ q,#__ID__ s,#__ID__ samp,#__ID__ small,#__ID__ strike,#__ID__ strong,#__ID__ sub,#__ID__ sup,#__ID__ tt,#__ID__ var,#__ID__ b,#__ID__ u,#__ID__ i,#__ID__ center,#__ID__ dl,#__ID__ dt,#__ID__ dd,#__ID__ ol,#__ID__ ul,#__ID__ li,#__ID__ fieldset,#__ID__ form,#__ID__ label,#__ID__ legend,#__ID__ table,#__ID__ caption,#__ID__ tbody,#__ID__ tfoot,#__ID__ thead,#__ID__ tr,#__ID__ th,#__ID__ td,#__ID__ article,#__ID__ aside,#__ID__ canvas,#__ID__ details,#__ID__ embed,#__ID__ figure,#__ID__ figcaption,#__ID__ footer,#__ID__ header,#__ID__ hgroup,#__ID__ menu,#__ID__ nav,#__ID__ output,#__ID__ ruby,#__ID__ section,#__ID__ summary,#__ID__ time,#__ID__ mark,#__ID__ audio,#__ID__ video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#__ID__ table{border-collapse:collapse;border-spacing:0}#__ID__ caption,#__ID__ th,#__ID__ td{text-align:left;font-weight:normal;vertical-align:middle}#__ID__ q,#__ID__ blockquote{quotes:none}#__ID__ q:before,#__ID__ q:after,#__ID__ blockquote:before,#__ID__ blockquote:after{content:"";content:none}#__ID__ a img{border:none}#__ID__ *{visibility:visible;font-weight:500;-webkit-box-shadow:0px 0px 5px transparent;-moz-box-shadow:0px 0px 5px transparent;box-shadow:0px 0px 5px transparent;text-shadow:transparent 0px 0px 1px;-webkit-border-radius:0;-moz-border-radius:0;-ms-border-radius:0;-o-border-radius:0;border-radius:0;margin:0;padding:0;position:static}#__ID__ ul{text-align:left}#__ID__ .toggle-widget{float:right !important;background:#fff !important;border:1px solid #ccc !important;color:#911 !important;cursor:pointer !important;height:20px !important;width:78px !important;display:block !important;min-width:78px !important;min-height:20px !important;font-size:12px !important;line-height:1em !important;font-weight:500 !important}#__ID__ .toggle-widget:active,#__ID__ .toggle-widget.active{background:#911 !important;color:#fff !important}#__ID__ .coffee-source{font-family:monospace;font-size:15px;min-width:400px;height:22px;margin:4px}#__ID__ .input{display:none}#__ID__ .history{margin:8px;padding:4px;font-family:monospace;list-style-type:circle;overflow-y:scroll}#__ID__ .history li{padding:4px 1em 4px 4px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;position:relative}#__ID__ .history li:hover{list-style-type:disc}#__ID__ .history li.cs-error{color:orange}#__ID__ .history li.js-error{color:red}#__ID__ .history li.object span.result{cursor:pointer}#__ID__ .history li.property-value{list-style-type:none}#__ID__ .history li.property-value span.property{color:purple}#__ID__ .history li li{padding-left:3em}#__ID__ .history li button{cursor:pointer}#__ID__ .history li button.load{position:absolute;right:0;top:0;border:1px solid #ccc;padding:2px;background:#fff}#__ID__ .history li button.load:hover{background-color:rgba(255,255,0,0.2)}#__ID__ .history li button.load:active{background-color:rgba(255,255,0,0.8)}#__ID__ .history li button.expand{background:transparent;border:0;width:1em}#__ID__ .history li span.opened{display:none}#__ID__ .history li.open > button span.opened,#__ID__ .history li.open > span.value > button span.opened{display:inline}#__ID__ .history li.open > button span.closed,#__ID__ .history li.open > span.value > button span.closed{display:none}#__ID__ p.instructions{text-align:center}#__ID__ .clear,#__ID__ .replay{padding:4px;text-align:center;cursor:pointer;float:left;color:#555;font-variant:small-caps;display:none}#__ID__ .clear:hover,#__ID__ .replay:hover{color:#911}#__ID__ a{padding:4px;text-align:center;cursor:pointer;float:right;color:#555;font-variant:small-caps;text-decoration:none}#__ID__ input{vertical-align:middle}#__ID__ p.mode{padding:4px;margin:0;float:right;display:inline-block;width:80px;color:#555;font-variant:small-caps;display:none;text-align:right}#__ID__ .autosuggest{-webkit-box-shadow:0px 0px 4px #222;-moz-box-shadow:0px 0px 4px #222;box-shadow:0px 0px 4px #222;position:absolute;top:-2px;left:-260px;display:block;background:rgba(255,255,255,0.9);width:250px;overflow-y:scroll;font-family:monospace}#__ID__ .autosuggest li{padding:4px}#__ID__ .autosuggest li.heading{font-weight:bold;text-decoration:underline;list-style-type:none}#__ID__ .function{color:#292}#__ID__ .number{color:#229}#__ID__ .string{color:#922}#__ID__ .undefined{color:grey;font-style:italic}#__ID__ .object{color:#000}#__ID__ .boolean{color:#299}\n    </style>\n    <button class="toggle-widget">CoffeeTable</button>\n    <span class="clear">clear</span><span class="replay">replay</span>\n    <a href="http://code.alecperkins.net/coffeetable/" target="_blank">?</a>\n    <p class="mode">multiline <input type="checkbox"></p>\n    <div class="input">\n        <textarea class="coffee-source"></textarea>\n        <p class="instructions"></p>\n        <ul class="autosuggest"></ul>\n        <ul class="history"></ul>\n    </div>\n</div>';
b=d=l=null;s=v=A=q=!1;k=0;i={jquery_js:!1,coffeescript_js:!1};h=[];B=function(a){a==null&&(a={});if(i.jquery_js&&i.coffeescript_js){l=window.jQuery;if(d.adopt_log){if(typeof console==="undefined"||console===null)console={};console.log=function(){var a;a=1<=arguments.length?p.call(arguments,0):[];return z.apply(null,a)}}if(d.adopt_dir){if(typeof console==="undefined"||console===null)console={};console.dir=function(){1<=arguments.length&&p.call(arguments,0)}}if(d.alias_log&&window.log==null)window.log=
function(){return console.log.apply(console,arguments)};if(d.alias_dir&&window.dir==null)window.dir=function(){return console.dir.apply(console,arguments)};y=y.replace(/__ID__/g,d.widget_id);M();d.local_storage&&K();v=!0}return v};z=function(){var a,b,e,g,f;b=1<=arguments.length?p.call(arguments,0):[];e=function(){var b;b=a.toString().replace(/\'/g,"\\'").replace(/\"/g,'\\"');return r("'log: "+b+"'")};g=0;for(f=b.length;g<f;g++)a=b[g],e()};I=function(){1<=arguments.length&&p.call(arguments,0)};H=
function(a,c){var e,g,f,d,h,l,o,j,n,k,i;if(c.which===m.ESCAPE||c.which===m.BACKSPACE&&a.length===0&&b.autosuggest_list.html().length!==0)return b.autosuggest_list.html("");else{h=a.split(".");o=[[window,"window"]];k=h.slice(0,h.length-1);j=0;for(n=k.length;j<n;j++)g=k[j],g=g.replace("(","").replace(")",""),g.length>0&&o.push([o[o.length-1][0][g],g]);g=[];try{d=RegExp("^"+h[h.length-1]);i=o[o.length-1][0];for(e in i)l=i[e],f=d.exec(e),(f!=null?f.length:void 0)>0&&g.push([e,typeof l]);g.sort();return L(o,
g)}catch(p){}}};L=function(a,c){var e,g,f,d;e="";f=0;for(d=a.length;f<d;f++)g=a[f],e+=g[1]+".";e="<li class='current-object'>"+e+"</li>";f=0;for(d=c.length;f<d;f++)g=c[f],e+="<li class='"+g[1]+"'>"+g[0]+"</li>";b.autosuggest_list.html(e);return x()};K=function(){var a,b,e,g,f;if(typeof localStorage!=="undefined"&&localStorage!==null){if(b=localStorage.getItem(d.ls_key),b!=null){b=JSON.parse(b);f=[];e=0;for(g=b.length;e<g;e++)a=b[e],f.push(r(a,!d.replay_on_load));return f}}else throw"localStorage not supported by this browser. History will not be persisted.";
};E=function(){var a,c,e,d,f;a=function(){var a,b,e;e=[];a=0;for(b=h.length;a<b;a++)c=h[a],e.push(c.source);return e}();h=[];b.history_list.empty();k=0;f=[];e=0;for(d=a.length;e<d;e++)c=a[e],f.push(r(c));return f};r=function(a,c){var e,g,f,i,m,p,o,j,n,q;c==null&&(c=!1);if(a==="localStorage.clear()")return t();else{h.length===0&&b.history_list.empty();k=-1;f=null;o=m=!1;try{i=CoffeeScript.compile(a,{bare:!0})}catch(r){m=!0,f=r}if(f==null&&!c)try{n=eval.call(window,i)}catch(s){o=!0,f=s}else c&&(n=i);
f!=null&&(n=f);h.push({result:n,source:a});q=h.length-1;i=l('<button class="load">^</button>');f=n.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");j=l("<li class='"+typeof n+"' title='"+typeof n+": "+f+"'>\n    "+q+":\n    <span class='result'>"+f+"</span>\n</li>").append(i);typeof n==="object"&&(g=function(a,b){return l("<li class='property-value' title='"+typeof b+": "+b+"'>\n    <span class='property'>"+a+":</span>\n    <span class='value "+typeof b+"'>"+b+"</span>\n</li>")},
e=function(a,b){var d,f,c,h,i,j;b.children("ul").remove();d=l("<ul></ul>");b.append(d);c=function(){var b;b=[];for(f in a)b.push(f);return b}();c.sort();j=[];h=0;for(i=c.length;h<i;h++)f=c[h],j.push(function(){var b,c,h;b=f;h=a[f];c=g(b,h);d.append(c);if(typeof h==="object")return b=l('<button class="expand"><span class="closed">+</span><span class="opened">-</span></button>'),c.children("span.value").prepend(b),b.click(function(a){a.stopPropagation();return c.hasClass("open")?(c.removeClass("open"),
c.find("ul").remove()):(c.addClass("open"),d.show(),e(h,c))})}());return j},f=l('<button class="expand"><span class="closed">+</span><span class="opened">-</span></button>'),j.children("span.result").before(f),f.click(function(){return j.hasClass("open")?(j.removeClass("open"),j.find("ul").remove()):(j.addClass("open"),e(n,j))}));o?j.addClass("js-error"):m&&j.addClass("cs-error");i.click(function(){u(!1,q);return b.textarea.focus()});j.prependTo(b.history_list);m=function(){var a,b,c;c=[];a=0;for(b=
h.length;a<b;a++)p=h[a],c.push(p.source);return c}();typeof localStorage!=="undefined"&&localStorage!==null&&localStorage.setItem(d.ls_key,JSON.stringify(m));b.clear_history.show();return b.replay_history.show()}};t=function(){b.history_list.empty();h=[];typeof localStorage!=="undefined"&&localStorage!==null&&localStorage.removeItem(d.ls_key);w();b.clear_history.hide();return b.replay_history.hide()};w=function(){var a;if(h.length===0)return a=s?"type CoffeeScript, press <shift+enter>":"type CoffeeScript, press <enter>",
b.instructions.text(a)};u=function(a,c){a==null&&(a=!1);c!=null&&(k=c+1);k===-1||k===0?k=h.length-1:a?k+=1:k-=1;if(h.length>0)return b.textarea.val(h[k].source),b.textarea.selectionStart=0,b.textarea.selectionEnd=0};N=function(){var a;(s=!s)?(a="4em",b.autosuggest_list.hide()):(a="",d.auto_suggest&&b.autosuggest_list.show());b.textarea.css("height",a).focus();return w()};x=function(){var a;a=""+(window.innerHeight-140)+"px";b.autosuggest_list.css({"max-height":a,"max-width":""+(window.innerWidth-
255)+"px"});return b.history_list.css("max-height",a)};M=function(){var a;a=l(y);b={widget:a,textarea:a.find("textarea"),autosuggest_list:a.find("ul.autosuggest"),history_list:a.find("ul.history"),button:a.find("button"),div:a.find("div"),clear_history:a.find("span.clear"),replay_history:a.find("span.replay"),a:a.find("a"),toggle_multiline:a.find("input"),p:a.find("p.mode"),instructions:a.find("p.instructions"),li:a.find("li")};b.widget.css({position:""+d.widget_position,top:""+d.widget_top,right:""+
d.widget_right});w();G();a.appendTo("body");return x()};G=function(){b.button.click(function(){return(q=!q)?(b.div.show(),b.p.show(),b.textarea.focus(),b.button.addClass("active")):(b.div.hide(),b.p.hide(),b.button.removeClass("active"))});b.clear_history.click(function(){return t()});b.replay_history.click(function(){b.history_list.empty();return setTimeout(function(){return E()},100)});b.toggle_multiline.click(function(){return N()});b.textarea.bind("keydown",function(a){var c;c=b.textarea.val();
this.selectionStart===0&&(a.which===m.UP?u():a.which===m.DOWN&&u(!0));if(a.which===m.ENTER&&(!s||a.shiftKey)){if(a.preventDefault(),c!=="")return r(c),b.textarea.val("")}else if(a.which===m.TAB)return a.preventDefault(),a=this.selectionStart,this.value=this.value.substring(0,a)+d.indent+this.value.substring(a),this.selectionStart=a+d.indent.length,this.selectionEnd=a+d.indent.length});b.textarea.bind("keyup",function(a){var c;c=b.textarea.val();if(!d.multi_line&&d.auto_suggest)return H(c,a)});d.multi_line&&
b.toggle_multiline.click();return l(window).resize(function(){return x()})};O=function(){b!=null&&b.widget.remove();window.CoffeeTable=null;return delete window.CoffeeTable};window.CoffeeTable={show:function(){b.widget.show();return this},hide:function(){b.widget.hide();return this},clear:function(){t();return this},replay:function(){E();return this},deferInit:function(){A=!0;return this},init:function(a){var b;(b=window.CoffeeTable)!=null&&b.unload();F(a);D();return this},unload:function(){O();return this},
active:function(){return q},log:function(){var a;a=1<=arguments.length?p.call(arguments,0):[];return z.apply(null,a)},dir:function(){var a;a=1<=arguments.length?p.call(arguments,0):[];return I.apply(null,a)}};F=function(a){var b,e,g;d=J;g=[];for(b in a)e=a[b],g.push(d[b]=e);return g};C=function(a){var b,e;b=document.getElementsByTagName("head")[0];e=document.createElement("script");e.type="application/javascript";e.src=d[a];e.async=!0;e.onload=function(){i[a]=!0;return B()};return b.appendChild(e)};
D=function(){q=!1;i.jquery_js=window.jQuery!=null;i.coffeescript_js=window.CoffeeScript!=null;if(!i.coffeescript_js)if(d.autoload_coffee_script)C("coffeescript_js");else throw"CoffeeTable requires coffee_script.js";if(!i.jquery_js)if(d.autoload_jquery)C("jquery_js");else throw"CoffeeTable requires jQuery";return B()};document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1);if(!A&&!v)return F(),D()},!1)}).call(this);
