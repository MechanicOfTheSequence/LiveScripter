(function(){var o,b,q,r,F,G,s,H,x,t,i,k,y,p,I,u,z,A,m,B,J,K,L,C,g,D,v,M;H={autoload_coffee_script:true,autoload_jquery:true,coffeescript_js:"http://code.alecperkins.net/coffeetable/lib/coffee_script-1.1.1-min.js",jquery_js:"lib/jquery-1.6.2-min.js",local_storage:true,ls_key:"coffee-table",clear_on_load:false,multi_line:false,indent:"    ",auto_suggest:true,widget_position:"fixed",widget_top:"5px",widget_right:"5px",widget_id:"CoffeeTable-"+(new Date).getTime()};typeof console!=="undefined"&&console!==
null||(console={log:function(){},dir:function(){}});if(window.log==null)window.log=function(){return console.log.apply(console,arguments)};if(window.dir==null)window.dir=function(){return console.dir.apply(console,arguments)};p={UP:38,DOWN:40,ENTER:13,TAB:9,BACKSPACE:8};v='<div id="__ID__"><style type="text/css">#__ID__{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline;-moz-box-shadow:0px 0px 4px #222222;-webkit-box-shadow:0px 0px 4px #222222;-o-box-shadow:0px 0px 4px #222222;box-shadow:0px 0px 4px #222222;background:rgba(255,255,255,0.93);padding:0;border:2px solid #fff;z-index:2147483647;font-size:12px;max-height:95%;max-width:900px}#__ID__ div,#__ID__ span,#__ID__ applet,#__ID__ object,#__ID__ iframe,#__ID__ h1,#__ID__ h2,#__ID__ h3,#__ID__ h4,#__ID__ h5,#__ID__ h6,#__ID__ p,#__ID__ blockquote,#__ID__ pre,#__ID__ a,#__ID__ abbr,#__ID__ acronym,#__ID__ address,#__ID__ big,#__ID__ cite,#__ID__ code,#__ID__ del,#__ID__ dfn,#__ID__ em,#__ID__ img,#__ID__ ins,#__ID__ kbd,#__ID__ q,#__ID__ s,#__ID__ samp,#__ID__ small,#__ID__ strike,#__ID__ strong,#__ID__ sub,#__ID__ sup,#__ID__ tt,#__ID__ var,#__ID__ b,#__ID__ u,#__ID__ i,#__ID__ center,#__ID__ dl,#__ID__ dt,#__ID__ dd,#__ID__ ol,#__ID__ ul,#__ID__ li,#__ID__ fieldset,#__ID__ form,#__ID__ label,#__ID__ legend,#__ID__ table,#__ID__ caption,#__ID__ tbody,#__ID__ tfoot,#__ID__ thead,#__ID__ tr,#__ID__ th,#__ID__ td,#__ID__ article,#__ID__ aside,#__ID__ canvas,#__ID__ details,#__ID__ embed,#__ID__ figure,#__ID__ figcaption,#__ID__ footer,#__ID__ header,#__ID__ hgroup,#__ID__ menu,#__ID__ nav,#__ID__ output,#__ID__ ruby,#__ID__ section,#__ID__ summary,#__ID__ time,#__ID__ mark,#__ID__ audio,#__ID__ video{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}#__ID__ table{border-collapse:collapse;border-spacing:0}#__ID__ caption,#__ID__ th,#__ID__ td{text-align:left;font-weight:normal;vertical-align:middle}#__ID__ q,#__ID__ blockquote{quotes:none}#__ID__ q:before,#__ID__ q:after,#__ID__ blockquote:before,#__ID__ blockquote:after{content:"";content:none}#__ID__ a img{border:none}#__ID__ .toggle-widget{float:right;background:#fff;border:1px solid #ccc;color:#911;cursor:pointer}#__ID__ .toggle-widget:active{background:#911;color:#fff}#__ID__ .coffee-source{font-family:monospace;font-size:15px;min-width:400px;height:22px;margin:4px}#__ID__ .input{display:none}#__ID__ .history{margin:8px;padding:4px 4px 4px 16px;font-family:monospace;list-style-type:circle;overflow-y:scroll}#__ID__ .history li{padding:4px;cursor:pointer}#__ID__ .history li:hover{background-color:rgba(255,255,0,0.2);list-style-type:disc}#__ID__ .history li:active{background-color:rgba(255,255,0,0.8)}#__ID__ .history li.cs-error{color:orange}#__ID__ .history li.js-error{color:red}#__ID__ .history li.instructions{list-style-type:none;text-align:center}#__ID__ .clear{padding:4px;text-align:center;cursor:pointer;float:left;color:#555;font-variant:small-caps;display:none}#__ID__ .clear:hover{color:#911}#__ID__ a{padding:4px;text-align:center;cursor:pointer;float:right;color:#555;font-variant:small-caps}#__ID__ input{vertical-align:middle}#__ID__ p{padding:4px;margin:0;float:right;display:inline-block;width:80px;color:#555;font-variant:small-caps;display:none;text-align:right}#__ID__ .autosuggest{-moz-box-shadow:0px 0px 4px #222222;-webkit-box-shadow:0px 0px 4px #222222;-o-box-shadow:0px 0px 4px #222222;box-shadow:0px 0px 4px #222222;position:absolute;top:-2px;left:-300px;display:block;background:rgba(255,255,255,0.9);width:250px;overflow-y:scroll;font-family:monospace}#__ID__ .autosuggest li{padding:4px}#__ID__ .autosuggest li.heading{font-weight:bold;text-decoration:underline;list-style-type:none}#__ID__ .function{color:#292}#__ID__ .number{color:#229}#__ID__ .string{color:#922}#__ID__ .undefined{color:grey;font-style:italic}#__ID__ .object{color:inherit}#__ID__ .boolean{color:#299}</style><button class="toggle-widget">CoffeeTable</button><span class="clear">clear</span><a href="http://code.alecperkins.net/coffeetable/" target="_blank">?</a><p>multiline <input type="checkbox"></p><div class="input"><textarea class="coffee-source"></textarea><ul class="autosuggest"></ul><ul class="history"></ul></div></div>';
b=g=o=null;D=A=x=q=false;k=0;m={jquery_js:false,coffeescript_js:false};i=[];y=function(){if(m.jquery_js&&m.coffeescript_js){o=window.jQuery;v=v.replace(/__ID__/g,g.widget_id);K();g.local_storage&&I();return A=true}};G=function(a,c){var d,e,f,h,l,j,n;if(c.which===p.BACKSPACE&&a.length===0&&b.autosuggest_list.html().length!==0)return b.autosuggest_list.html("");else{f=a.split(".");j=[[window,"window"]];n=f.slice(0,f.length-1);h=0;for(l=n.length;h<l;h++){e=n[h];e=e.replace("(","").replace(")","");e.length>
0&&j.push([j[j.length-1][0][e],e])}e=[];h=RegExp("^"+f[f.length-1]);n=j[j.length-1][0];for(d in n){l=n[d];f=h.exec(d);if((f!=null?f.length:void 0)>0)e.push([d,typeof l])}e.sort();return J(j,e)}};J=function(a,c){var d,e,f,h;d="";f=0;for(h=a.length;f<h;f++){e=a[f];d+=e[1]+"."}d="<li class='current-object'>"+d+"</li>";f=0;for(h=c.length;f<h;f++){e=c[f];d+="<li class='"+e[1]+"'>"+e[0]+"</li>"}return b.autosuggest_list.html(d)};I=function(){var a,c,d,e,f;if(typeof localStorage!=="undefined"&&localStorage!==
null){c=localStorage.getItem(g.ls_key);if(c!=null){c=JSON.parse(c);f=[];d=0;for(e=c.length;d<e;d++){a=c[d];f.push(t(a))}return f}}else throw"localStorage not supported by this browser. History will not be persisted";};L=function(){var a,c,d,e;b.history_list.empty();e=[];c=0;for(d=i.length;c<d;c++){a=i[c];e.push(t(a.source))}return e};t=function(a){var c,d,e,f,h,l,j;if(a==="localStorage.clear()")return s();else{i.length===0&&b.history_list.empty();k=-1;f=null;h=d=false;try{c=CoffeeScript.compile(a,
{bare:true})}catch(n){d=true;f=n}if(f==null)try{l=eval.call(window,c)}catch(O){h=true;f=O}if(f!=null)l=f;i.push({result:l,source:a});j=i.length-1;a=o("<li class=''>"+j+": "+l+"</li>");if(h)a.addClass("js-error");else d&&a.addClass("cs-error");a.click(function(){u(false,j);return b.textarea.focus()});a.prependTo(b.history_list);d=function(){var w,N,E;E=[];w=0;for(N=i.length;w<N;w++){e=i[w];E.push(e.source)}return E}();typeof localStorage!=="undefined"&&localStorage!==null&&localStorage.setItem(g.ls_key,
JSON.stringify(d));return b.clear_history.show()}};s=function(){b.history_list.empty();i=[];typeof localStorage!=="undefined"&&localStorage!==null&&localStorage.removeItem(g.ls_key);r();return b.clear_history.hide()};r=function(){var a;if(i.length===0){a=g.multi_line?"type CoffeeScript, press shift+enter":"type CoffeeScript, press enter";a=o("<li class='instructions'>"+a+"</li>");return a.appendTo(b.history_list)}};u=function(a,c){if(a==null)a=false;if(c!=null)k=c+1;if(k===-1||k===0)k=i.length-1;
else if(a)k+=1;else k-=1;if(i.length>0){b.textarea.val(i[k].source);b.textarea.selectionStart=0;return b.textarea.selectionEnd=0}};M=function(){var a;if(D=!D){a="4em";b.autosuggest_list.hide()}else{a="";g.auto_suggest&&b.autosuggest_list.show()}b.textarea.css("height",a).focus();return r()};K=function(){var a;a=o(v);b={widget:a,textarea:a.find("textarea"),autosuggest_list:a.find("ul.autosuggest"),history_list:a.find("ul.history"),button:a.find("button"),div:a.find("div"),clear_history:a.find("span"),
a:a.find("a"),toggle_multiline:a.find("input"),p:a.find("p"),li:a.find("li")};b.widget.css({position:""+g.widget_position,top:""+g.widget_top,right:""+g.widget_right});r();F();return a.appendTo("body")};F=function(){b.button.click(function(){if(q){b.div.hide();b.p.hide()}else{b.div.show();b.p.show();b.textarea.focus()}return q=!q});b.clear_history.click(function(){return s()});b.toggle_multiline.click(function(){return M()});b.textarea.bind("keydown",function(a){var c;c=b.textarea.val();if(this.selectionStart===
0)if(a.which===p.UP)u();else a.which===p.DOWN&&u(true);if(a.which===p.ENTER&&(!g.multi_line||a.shiftKey)){a.preventDefault();if(c!==""){t(c);return b.textarea.val("")}}else if(a.which===p.TAB){a.preventDefault();a=this.selectionStart;this.value=this.value.substring(0,a)+g.indent+this.value.substring(a);this.selectionStart=a+g.indent.length;return this.selectionEnd=a+g.indent.length}});b.textarea.bind("keyup",function(a){var c;c=b.textarea.val();if(!g.multi_line&&g.auto_suggest)return G(c,a)});g.multi_line&&
b.toggle_multiline.click();return o(window).resize(function(){var a;a=""+(window.innerHeight-140)+"px";b.autosuggest_list.css({"max-height":a,"max-width":""+(window.innerWidth-255)+"px"});return b.history_list.css("max-height",a)})};window.CoffeeTable={show:function(){b.widget.show();return this},hide:function(){b.widget.hide();return this},clear:function(){s();return this},replay:function(){L();return this},deferInit:function(){x=true;return this},init:function(a){C(a);B();return this}};C=function(a){var c,
d,e;g=H;e=[];for(c in a){d=a[c];e.push(g[c]=d)}return e};z=function(a){var c,d;c=document.getElementsByTagName("head")[0];d=document.createElement("script");d.type="application/javascript";d.src=g[a];d.async=true;d.onload=function(){m[a]=true;return y()};return c.appendChild(d)};B=function(){var a;if(b!=null)if((a=b.widget)!=null)a.remove();q=false;m.jquery_js=window.jQuery!=null;m.coffeescript_js=window.CoffeeScript!=null;if(!m.jquery_js)if(g.autoload_coffee_script)z("coffeescript_js");else throw"CoffeeTable requires coffee_script.js";
if(!m.coffeescript_js)if(g.autoload_jquery)z("jquery_js");else throw"CoffeeTable requires jQuery";return y()};document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,false);if(!x&&!A){C();return B()}},false)}).call(this);
